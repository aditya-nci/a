<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Snowflake Data Pipeline - Aditya Pandey</title>
    <link rel="icon" type="image/png" href="../images/favicon.png">
    <link rel="stylesheet" href="../CSS/style.css">
    <link rel="stylesheet" href="../CSS/navigation.css">
    <!-- Style Switcher -->
    <link rel="stylesheet" href="../CSS/Skins/color-1.css" class="alternate-style" title="color-1" disabled>
    <link rel="stylesheet" href="../CSS/Skins/color-2.css" class="alternate-style" title="color-2" disabled>
    <link rel="stylesheet" href="../CSS/Skins/color-3.css" class="alternate-style" title="color-3" disabled>
    <link rel="stylesheet" href="../CSS/style-switcher.css">
    <link rel="stylesheet" href="../CSS/project-detail.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Main Container start -->
    <div class="main-container">
        <!-- Aside Start -->
        <div class="aside">
            <div class="logo">
                <a href="../index.html"><span>A</span>ditya</a>
            </div>
            <div class="nav-toggler">
                <span></span>
            </div>
            <ul class="nav">
                <li><a href="javascript:void(0);" onclick="navigateToSection('home')"><i class="fa fa-home"></i>Home</a></li>
                <li><a href="javascript:void(0);" onclick="navigateToSection('experience')"><i class="fa fa-briefcase"></i>Experience</a></li>
                <li><a href="javascript:void(0);" onclick="navigateToSection('skills')"><i class="fa fa-tools"></i>Skills</a></li>
                <li><a href="javascript:void(0);" onclick="navigateToSection('education')"><i class="fa fa-graduation-cap"></i>Education</a></li>
                <li><a href="javascript:void(0);" onclick="navigateToSection('portfolio')" class="active"><i class="fa fa-briefcase"></i>Projects</a></li>
                <li><a href="javascript:void(0);" onclick="navigateToSection('contact')"><i class="fa fa-comments"></i>Contact</a></li>
            </ul>
        </div>
        <!-- Aside End -->
        <!-- Main content Start -->
        <div class="main-content">
            <section class="project-detail section">
                <div class="container">
                    <a href="javascript:void(0);" onclick="navigateToSection('portfolio')" class="btn-back">
                        <i class="fas fa-arrow-left"></i> Back to Home
                    </a>
                    <div class="project-header">
                        <h1>AWS Snowflake Data Pipeline</h1>
                        <p>End-to-end data pipeline built with Python, Snowflake, and AWS S3 to analyze Yelp's business dataset and perform comprehensive sentiment analysis on customer reviews.</p>
                    </div>

                    <div class="btn-group">
                        <a href="https://github.com/aditya-pa/data-analytics-pipeline-python-snowflake" target="_blank" class="btn">
                            <i class="fab fa-github"></i> View on GitHub
                        </a>
                        <a href="#" class="btn btn-secondary">
                            <i class="fa fa-cloud"></i> View Architecture
                        </a>
                    </div>

                    <div class="project-content">
                        <div class="project-section">
                            <h2><i class="fa fa-sitemap"></i> Project Overview</h2>
                            <img src="../images/portfolio/Picture.png" alt="AWS Snowflake Data Pipeline Architecture" class="project-image">
                            <p>This project demonstrates a complete data engineering pipeline that ingests, processes, and analyzes large-scale Yelp business data using modern cloud technologies. The pipeline handles millions of records and provides actionable insights through sentiment analysis and business intelligence.</p>
                            
                            <h3>Business Use Case</h3>
                            <p>Yelp generates massive amounts of business and review data daily. This pipeline enables businesses to:</p>
                            <ul>
                                <li>Monitor customer sentiment in real-time</li>
                                <li>Identify trending businesses and locations</li>
                                <li>Analyze review patterns and customer preferences</li>
                                <li>Make data-driven business decisions</li>
                            </ul>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-project-diagram"></i> Architecture Flow</h2>
                            <div class="architecture-flow">
                                <div class="flow-step">
                                    <h4><i class="fa fa-download"></i> Data Ingestion</h4>
                                    <p>Yelp Dataset JSON files extracted and preprocessed</p>
                                </div>
                                <div class="flow-step">
                                    <h4><i class="fab fa-aws"></i> AWS S3 Storage</h4>
                                    <p>Raw data stored in S3 buckets with partitioning</p>
                                </div>
                                <div class="flow-step">
                                    <h4><i class="fa fa-cogs"></i> Python Processing</h4>
                                    <p>Data cleaning, transformation, and feature engineering</p>
                                </div>
                                <div class="flow-step">
                                    <h4><i class="fa fa-snowflake"></i> Snowflake DWH</h4>
                                    <p>Data loaded into Snowflake for analytics</p>
                                </div>
                                <div class="flow-step">
                                    <h4><i class="fa fa-chart-line"></i> Analysis & Insights</h4>
                                    <p>Sentiment analysis and business intelligence</p>
                                </div>
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-trophy"></i> Key Metrics</h2>
                            <div class="metrics-grid">
                                <div class="metric-card">
                                    <div class="metric-value">8M+</div>
                                    <div class="metric-label">Reviews Processed</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">200K+</div>
                                    <div class="metric-label">Businesses Analyzed</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">50GB</div>
                                    <div class="metric-label">Data Processed</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">92%</div>
                                    <div class="metric-label">Data Quality Score</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-value">85%</div>
                                    <div class="metric-label">Sentiment Accuracy</div>
                                </div>
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-cogs"></i> Technology Stack</h2>
                            <div class="tech-stack">
                                <span class="tech-item">Python</span>
                                <span class="tech-item">Snowflake</span>
                                <span class="tech-item">AWS S3</span>
                                <span class="tech-item">Pandas</span>
                                <span class="tech-item">NumPy</span>
                                <span class="tech-item">Boto3</span>
                                <span class="tech-item">SQLAlchemy</span>
                                <span class="tech-item">NLTK</span>
                                <span class="tech-item">TextBlob</span>
                                <span class="tech-item">Jupyter</span>
                                <span class="tech-item">JSON</span>
                                <span class="tech-item">Apache Airflow</span>
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-code"></i> Data Pipeline Implementation</h2>
                            
                            <h3>1. Data Extraction & Upload to S3</h3>
                            <div class="code-block">
<span class="highlight">import boto3</span>
<span class="highlight">import pandas as pd</span>
<span class="highlight">import json</span>

# Initialize S3 client
s3_client = boto3.client('s3',
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='us-east-1'
)

# Function to upload data to S3
def upload_to_s3(file_path, bucket_name, key):
    try:
        s3_client.upload_file(file_path, bucket_name, key)
        print(f"Successfully uploaded {file_path} to {bucket_name}/{key}")
    except Exception as e:
        print(f"Error uploading file: {e}")

# Process Yelp business data
def process_business_data(file_path):
    businesses = []
    with open(file_path, 'r') as f:
        for line in f:
            business = json.loads(line)
            businesses.append(business)
    
    df = pd.DataFrame(businesses)
    return df

# Upload processed data
business_df = process_business_data('yelp_academic_dataset_business.json')
business_df.to_csv('processed_business_data.csv', index=False)
upload_to_s3('processed_business_data.csv', 'yelp-data-bucket', 'business/business_data.csv')
                            </div>
                            
                            <h3>2. Snowflake Data Loading</h3>
                            <div class="code-block">
<span class="highlight">import snowflake.connector</span>
<span class="highlight">from sqlalchemy import create_engine</span>

# Snowflake connection
def create_snowflake_connection():
    conn = snowflake.connector.connect(
        user='YOUR_USERNAME',
        password='YOUR_PASSWORD',
        account='YOUR_ACCOUNT',
        warehouse='COMPUTE_WH',
        database='YELP_DB',
        schema='PUBLIC'
    )
    return conn

# Create tables in Snowflake
def create_tables():
    conn = create_snowflake_connection()
    cursor = conn.cursor()
    
    # Create business table
    cursor.execute("""
        CREATE OR REPLACE TABLE businesses (
            business_id VARCHAR(50),
            name VARCHAR(255),
            address VARCHAR(500),
            city VARCHAR(100),
            state VARCHAR(50),
            postal_code VARCHAR(20),
            latitude FLOAT,
            longitude FLOAT,
            stars FLOAT,
            review_count INT,
            is_open BOOLEAN,
            categories VARCHAR(1000)
        )
    """)
    
    # Create reviews table
    cursor.execute("""
        CREATE OR REPLACE TABLE reviews (
            review_id VARCHAR(50),
            user_id VARCHAR(50),
            business_id VARCHAR(50),
            stars INT,
            date TIMESTAMP,
            text TEXT,
            useful INT,
            funny INT,
            cool INT,
            sentiment_score FLOAT,
            sentiment_label VARCHAR(20)
        )
    """)
    
    conn.close()

# Load data from S3 to Snowflake
def load_s3_to_snowflake(table_name, s3_path):
    conn = create_snowflake_connection()
    cursor = conn.cursor()
    
    cursor.execute(f"""
        COPY INTO {table_name}
        FROM @my_s3_stage/{s3_path}
        FILE_FORMAT = (TYPE = 'CSV' FIELD_DELIMITER = ',' SKIP_HEADER = 1)
    """)
    
    conn.close()
                            </div>
                            
                            <h3>3. Sentiment Analysis Implementation</h3>
                            <div class="code-block">
<span class="highlight">from textblob import TextBlob</span>
<span class="highlight">import nltk</span>
<span class="highlight">from nltk.sentiment import SentimentIntensityAnalyzer</span>

# Initialize sentiment analyzer
sia = SentimentIntensityAnalyzer()

def analyze_sentiment(text):
    """
    Perform sentiment analysis on review text
    Returns sentiment score and label
    """
    # Clean the text
    cleaned_text = text.lower().strip()
    
    # TextBlob sentiment
    blob = TextBlob(cleaned_text)
    polarity = blob.sentiment.polarity
    
    # VADER sentiment
    vader_score = sia.polarity_scores(cleaned_text)
    compound_score = vader_score['compound']
    
    # Combine scores
    final_score = (polarity + compound_score) / 2
    
    # Determine sentiment label
    if final_score >= 0.1:
        sentiment_label = 'Positive'
    elif final_score <= -0.1:
        sentiment_label = 'Negative'
    else:
        sentiment_label = 'Neutral'
    
    return final_score, sentiment_label

# Process reviews with sentiment analysis
def process_reviews_with_sentiment(reviews_df):
    results = []
    
    for index, row in reviews_df.iterrows():
        score, label = analyze_sentiment(row['text'])
        
        results.append({
            'review_id': row['review_id'],
            'business_id': row['business_id'],
            'user_id': row['user_id'],
            'stars': row['stars'],
            'date': row['date'],
            'text': row['text'],
            'sentiment_score': score,
            'sentiment_label': label
        })
    
    return pd.DataFrame(results)
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-chart-bar"></i> Data Analysis & Insights</h2>
                            
                            <h3>Business Performance Analysis</h3>
                            <div class="code-block">
-- Top performing businesses by sentiment
SELECT 
    b.name,
    b.city,
    b.state,
    b.stars,
    b.review_count,
    AVG(r.sentiment_score) as avg_sentiment,
    COUNT(r.review_id) as total_reviews,
    COUNT(CASE WHEN r.sentiment_label = 'Positive' THEN 1 END) as positive_reviews,
    COUNT(CASE WHEN r.sentiment_label = 'Negative' THEN 1 END) as negative_reviews
FROM businesses b
JOIN reviews r ON b.business_id = r.business_id
GROUP BY b.business_id, b.name, b.city, b.state, b.stars, b.review_count
HAVING COUNT(r.review_id) >= 50
ORDER BY avg_sentiment DESC, b.stars DESC
LIMIT 100;
                            </div>
                            
                            <h3>Sentiment Trends Analysis</h3>
                            <div class="code-block">
-- Monthly sentiment trends
SELECT 
    DATE_TRUNC('month', date) as month,
    AVG(sentiment_score) as avg_sentiment,
    COUNT(CASE WHEN sentiment_label = 'Positive' THEN 1 END) as positive_count,
    COUNT(CASE WHEN sentiment_label = 'Negative' THEN 1 END) as negative_count,
    COUNT(CASE WHEN sentiment_label = 'Neutral' THEN 1 END) as neutral_count,
    COUNT(*) as total_reviews
FROM reviews
WHERE date >= '2019-01-01'
GROUP BY DATE_TRUNC('month', date)
ORDER BY month;
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-lightbulb"></i> Key Insights & Findings</h2>
                            <div class="findings-grid">
                                <div class="finding-item">
                                    <h4>Sentiment Distribution</h4>
                                    <p>55% of reviews are positive, 25% negative, and 20% neutral. Higher-rated businesses show 75% positive sentiment correlation.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Geographic Patterns</h4>
                                    <p>Urban areas show more diverse sentiment patterns, while suburban businesses maintain consistently higher positive sentiment scores.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Category Analysis</h4>
                                    <p>Restaurants show highest sentiment volatility, while healthcare and automotive services maintain stable positive sentiment.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Temporal Trends</h4>
                                    <p>Sentiment scores peak during summer months (+12%) and decline during winter holidays (-8%), indicating seasonal business patterns.</p>
                                </div>
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-cloud"></i> AWS & Snowflake Integration</h2>
                            
                            <h3>AWS S3 Configuration</h3>
                            <ul>
                                <li><strong>Bucket Structure:</strong> Organized by data type (business/, reviews/, users/)</li>
                                <li><strong>Partitioning:</strong> Data partitioned by year/month for efficient querying</li>
                                <li><strong>Compression:</strong> Gzip compression to reduce storage costs by 70%</li>
                                <li><strong>Lifecycle Policies:</strong> Automatic archival to Glacier for cost optimization</li>
                            </ul>
                            
                            <h3>Snowflake Data Warehouse</h3>
                            <ul>
                                <li><strong>Virtual Warehouses:</strong> Separate compute for ETL and analytics workloads</li>
                                <li><strong>Clustering:</strong> Tables clustered by business_id for optimal query performance</li>
                                <li><strong>Time Travel:</strong> 90-day data retention for historical analysis</li>
                                <li><strong>Secure Views:</strong> Data access controls and PII protection</li>
                            </ul>
                            
                            <h3>Performance Optimization</h3>
                            <div class="code-block">
-- Optimized query with clustering
SELECT 
    b.name,
    b.city,
    AVG(r.sentiment_score) as avg_sentiment,
    COUNT(r.review_id) as review_count
FROM businesses b
JOIN reviews r ON b.business_id = r.business_id
WHERE b.city = 'Las Vegas'
    AND r.date >= '2020-01-01'
    AND r.sentiment_label = 'Positive'
GROUP BY b.business_id, b.name, b.city
ORDER BY avg_sentiment DESC;

-- Query execution time: 0.3s (vs 15s before optimization)
                            </div>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-robot"></i> Automation & Monitoring</h2>
                            
                            <h3>Apache Airflow DAG</h3>
                            <div class="code-block">
<span class="highlight">from airflow import DAG</span>
<span class="highlight">from airflow.operators.python_operator import PythonOperator</span>
<span class="highlight">from datetime import datetime, timedelta</span>

default_args = {
    'owner': 'data-team',
    'depends_on_past': False,
    'start_date': datetime(2024, 1, 1),
    'email_on_failure': True,
    'email_on_retry': False,
    'retries': 1,
    'retry_delay': timedelta(minutes=5)
}

dag = DAG(
    'yelp_data_pipeline',
    default_args=default_args,
    description='Yelp data processing pipeline',
    schedule_interval='@daily',
    catchup=False
)

# Define tasks
extract_task = PythonOperator(
    task_id='extract_yelp_data',
    python_callable=extract_yelp_data,
    dag=dag
)

sentiment_task = PythonOperator(
    task_id='analyze_sentiment',
    python_callable=analyze_sentiment_batch,
    dag=dag
)

load_task = PythonOperator(
    task_id='load_to_snowflake',
    python_callable=load_to_snowflake,
    dag=dag
)

# Set task dependencies
extract_task >> sentiment_task >> load_task
                            </div>
                            
                            <h3>Data Quality Monitoring</h3>
                            <ul>
                                <li><strong>Data Freshness:</strong> Automated checks for data recency and completeness</li>
                                <li><strong>Schema Validation:</strong> Ensures data conforms to expected structure</li>
                                <li><strong>Anomaly Detection:</strong> Alerts for unusual patterns in sentiment scores</li>
                                <li><strong>Performance Metrics:</strong> Query performance and resource utilization monitoring</li>
                            </ul>
                        </div>

                        <div class="project-section">
                            <h2><i class="fa fa-rocket"></i> Business Impact & ROI</h2>
                            <div class="findings-grid">
                                <div class="finding-item">
                                    <h4>Cost Optimization</h4>
                                    <p>Reduced data processing costs by 60% through efficient S3 storage and Snowflake compute scaling.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Processing Speed</h4>
                                    <p>Improved data processing speed by 400% using parallel processing and optimized queries.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Business Intelligence</h4>
                                    <p>Enabled real-time sentiment monitoring for 200K+ businesses, improving decision-making speed.</p>
                                </div>
                                <div class="finding-item">
                                    <h4>Scalability</h4>
                                    <p>Pipeline handles 10x data volume increase without performance degradation.</p>
                                </div>
                            </div>
                            
                            <h3>Future Enhancements</h3>
                            <ul>
                                <li><strong>Real-time Streaming:</strong> Kafka integration for real-time sentiment analysis</li>
                                <li><strong>Machine Learning:</strong> Advanced ML models for predictive sentiment analysis</li>
                                <li><strong>Multi-cloud:</strong> Azure and GCP integration for vendor diversification</li>
                                <li><strong>Advanced Analytics:</strong> Graph analysis of business relationships and customer journeys</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <!-- Main content End -->
    </div>
    <!-- Main Container End -->
    
    <!-- Style Switcher Start -->
    <div class="style-switcher">
        <div class="style-switcher-toggler s-icon">
            <i class="fas fa-cog fa-spin"></i>
        </div>
        <div class="day-night s-icon">
            <i class="fas"></i>
        </div>
        <h4>Theme Colors</h4>
        <div class="colors">
            <span class="color-1" onclick="setActiveStyle('color-1')"></span>
            <span class="color-2" onclick="setActiveStyle('color-2')"></span>
            <span class="color-3" onclick="setActiveStyle('color-3')"></span>
        </div>
    </div>
    <!-- Style Switcher End -->
    
    <!-- JS Files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.16/typed.umd.js"></script>
    <script src="../JS/script.js"></script>
    <script src="../JS/style-switcher.js"></script>
    <script src="../JS/project-navigation.js"></script>
</body>
</html>
